#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

CHANGED_FILES=$(git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD)

if echo "$CHANGED_FILES" | grep -q "package-lock.json"; then
  echo "ğŸ“¦ package-lock.json changed - running npm install..."
  npm install
fi

if echo "$CHANGED_FILES" | grep -q "supabase/migrations"; then
  echo "ğŸ—„ï¸  Database migrations changed - regenerating types..."
  npm run db:types
fi

echo "âœ… Post-merge checks complete!"

