#!/bin/sh
PREV_HEAD=$1
NEW_HEAD=$2
IS_BRANCH_CHECKOUT=$3

if [ "$IS_BRANCH_CHECKOUT" = "1" ]; then
  CHANGED_FILES=$(git diff --name-only "$PREV_HEAD" "$NEW_HEAD")
  
  if echo "$CHANGED_FILES" | grep -q "package-lock.json"; then
    echo "üì¶ package-lock.json changed - running npm install..."
    npm install
  fi
  
  if echo "$CHANGED_FILES" | grep -q "supabase/migrations"; then
    echo "üóÑÔ∏è  Database migrations changed - regenerating types..."
    npm run db:types
  fi
fi

