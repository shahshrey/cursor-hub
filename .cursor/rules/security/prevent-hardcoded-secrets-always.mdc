---
alwaysApply: false
---
# Prevent Hardcoded Secrets in Version Control

## Critical Rules

- **NEVER commit secrets** - API keys, tokens, team IDs, passwords, private URLs, or any sensitive identifiers must NEVER appear in any committed code or documentation files
- **Use environment variables** - All secrets must be stored in `.env` files (which are gitignored) and referenced via `process.env`, `import.meta.env`, or equivalent runtime variable access
- **Before every file edit** - Scan the content for patterns that look like secrets (hex strings, UUIDs, bearer tokens, API keys)
- **Before suggesting code** - Never include example secrets, API keys, or credentials in suggested code; use placeholder syntax like `process.env.LINEAR_TEAM_ID` or `YOUR_API_KEY_HERE`
- **On code review** - Flag any hardcoded secrets immediately, do not approve commits containing secrets
- **Documentation exclusion** - Even in documentation, examples, or markdown files, replace actual secrets with environment variable references or placeholder text

## Secret Patterns to Watch For

üî¥ **Critical secret types**:
- UUID patterns (likely API/team IDs): `[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}`
- Hex strings 32+ characters (API keys/tokens): `[a-f0-9]{32,}`
- Bearer tokens: `Bearer [a-zA-Z0-9._-]{40,}`
- Passwords/secrets in strings: `password|secret|token|key` followed by `=` or `:`
- Supabase/Firebase keys and URLs
- Database connection strings with credentials

## Implementation

**When adding/editing code**:
1. Identify any sensitive data that needs to be used
2. Create a placeholder for environment variable if not already defined
3. Reference it via `process.env.VARIABLE_NAME` (Node/Next.js) or equivalent
4. Add to `.env.example` with placeholder value (never the actual secret)
5. Ensure `.env` is in `.gitignore`

**If you accidentally commit a secret**:
1. Immediately revoke/rotate that secret in the actual service
2. Remove the secret from version control using git filter-branch or similar
3. Force push to remove from history
4. Never rely on removing secrets from old commits as sufficient protection

<example>
‚ùå **WRONG - Hardcoded secret in markdown**:
```markdown
team id for linear is - 13d53619-1527-43cd-afde-1ee9acca9f86
api_key: sk-1234567890abcdef
```

‚úÖ **CORRECT - Using environment variables**:
```markdown
team id for linear is - stored in process.env.LINEAR_TEAM_ID
api_key: stored in process.env.OPENAI_API_KEY
```

In code:
```typescript
const teamId = process.env.LINEAR_TEAM_ID
const apiKey = process.env.OPENAI_API_KEY
```

In `.env.example`:
```
LINEAR_TEAM_ID=your_team_id_here
OPENAI_API_KEY=your_api_key_here
```
</example>

<example type="invalid">
‚ùå **INVALID - Still commits secrets**:
```typescript
const API_KEY = "sk-proj-abc123def456ghi789"
const SECRET = "super-secret-value-xyz"
```

This violates the rule because secrets are still hardcoded, just in different formats.
</example>